!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t||self).SwupRouteNamePlugin=e()}(this,function(){function t(){return t=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},t.apply(this,arguments)}const e=t=>String(t).split(".").map(t=>String(parseInt(t||"0",10))).concat(["0","0"]).slice(0,3).join(".");class n{constructor(){this.isSwupPlugin=!0,this.swup=void 0,this.version=void 0,this.requires={},this.handlersToUnregister=[]}mount(){}unmount(){this.handlersToUnregister.forEach(t=>t()),this.handlersToUnregister=[]}_beforeMount(){if(!this.name)throw new Error("You must define a name of plugin when creating a class.")}_afterUnmount(){}_checkRequirements(){return"object"!=typeof this.requires||Object.entries(this.requires).forEach(([t,n])=>{if(!function(t,n,r){const o=function(t,e){var n;if("swup"===t)return null!=(n=e.version)?n:"";{var r;const n=e.findPlugin(t);return null!=(r=null==n?void 0:n.version)?r:""}}(t,r);return!!o&&((t,n)=>n.every(n=>{const[,r,o]=n.match(/^([\D]+)?(.*)$/)||[];var i,s;return((t,e)=>{const n={"":t=>0===t,">":t=>t>0,">=":t=>t>=0,"<":t=>t<0,"<=":t=>t<=0};return(n[e]||n[""])(t)})((s=o,i=e(i=t),s=e(s),i.localeCompare(s,void 0,{numeric:!0})),r||">=")}))(o,n)}(t,n=Array.isArray(n)?n:[n],this.swup)){const e=`${t} ${n.join(", ")}`;throw new Error(`Plugin version mismatch: ${this.name} requires ${e}`)}}),!0}on(t,e,n={}){var r;e=!(r=e).name.startsWith("bound ")||r.hasOwnProperty("prototype")?e.bind(this):e;const o=this.swup.hooks.on(t,e,n);return this.handlersToUnregister.push(o),o}once(e,n,r={}){return this.on(e,n,t({},r,{once:!0}))}before(e,n,r={}){return this.on(e,n,t({},r,{before:!0}))}replace(e,n,r={}){return this.on(e,n,t({},r,{replace:!0}))}off(t,e){return this.swup.hooks.off(t,e)}}function r(t,e){var n=[];return function(t,e,n){void 0===n&&(n={});var r=n.decode,o=void 0===r?function(t){return t}:r;return function(n){var r=t.exec(n);if(!r)return!1;for(var i=r[0],s=r.index,a=Object.create(null),u=function(t){if(void 0===r[t])return"continue";var n=e[t-1];a[n.name]="*"===n.modifier||"+"===n.modifier?r[t].split(n.prefix+n.suffix).map(function(t){return o(t,n)}):o(r[t],n)},c=1;c<r.length;c++)u(c);return{path:i,index:s,params:a}}}(s(t,n,e),n,e)}function o(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function i(t){return t&&t.sensitive?"":"i"}function s(t,e,n){return t instanceof RegExp?function(t,e){if(!e)return t;for(var n=/\((?:\?<(.*?)>)?(?!\?)/g,r=0,o=n.exec(t.source);o;)e.push({name:o[1]||r++,prefix:"",suffix:"",modifier:"",pattern:""}),o=n.exec(t.source);return t}(t,e):Array.isArray(t)?function(t,e,n){var r=t.map(function(t){return s(t,e,n).source});return new RegExp("(?:".concat(r.join("|"),")"),i(n))}(t,e,n):function(t,e,n){return function(t,e,n){void 0===n&&(n={});for(var r=n.strict,s=void 0!==r&&r,a=n.start,u=void 0===a||a,c=n.end,f=void 0===c||c,h=n.encode,p=void 0===h?function(t){return t}:h,d=n.delimiter,l=void 0===d?"/#?":d,m=n.endsWith,v="[".concat(o(void 0===m?"":m),"]|$"),g="[".concat(o(l),"]"),w=u?"^":"",y=0,E=t;y<E.length;y++){var x=E[y];if("string"==typeof x)w+=o(p(x));else{var R=o(p(x.prefix)),P=o(p(x.suffix));if(x.pattern)if(e&&e.push(x),R||P)if("+"===x.modifier||"*"===x.modifier){var b="*"===x.modifier?"?":"";w+="(?:".concat(R,"((?:").concat(x.pattern,")(?:").concat(P).concat(R,"(?:").concat(x.pattern,"))*)").concat(P,")").concat(b)}else w+="(?:".concat(R,"(").concat(x.pattern,")").concat(P,")").concat(x.modifier);else w+="+"===x.modifier||"*"===x.modifier?"((?:".concat(x.pattern,")").concat(x.modifier,")"):"(".concat(x.pattern,")").concat(x.modifier);else w+="(?:".concat(R).concat(P,")").concat(x.modifier)}}if(f)s||(w+="".concat(g,"?")),w+=n.endsWith?"(?=".concat(v,")"):"$";else{var N=t[t.length-1],O="string"==typeof N?g.indexOf(N[N.length-1])>-1:void 0===N;s||(w+="(?:".concat(g,"(?=").concat(v,"))?")),O||(w+="(?=".concat(g,"|").concat(v,")"))}return new RegExp(w,i(n))}(function(t,e){void 0===e&&(e={});for(var n=function(t){for(var e=[],n=0;n<t.length;){var r=t[n];if("*"!==r&&"+"!==r&&"?"!==r)if("\\"!==r)if("{"!==r)if("}"!==r)if(":"!==r)if("("!==r)e.push({type:"CHAR",index:n,value:t[n++]});else{var o=1,i="";if("?"===t[a=n+1])throw new TypeError('Pattern cannot start with "?" at '.concat(a));for(;a<t.length;)if("\\"!==t[a]){if(")"===t[a]){if(0==--o){a++;break}}else if("("===t[a]&&(o++,"?"!==t[a+1]))throw new TypeError("Capturing groups are not allowed at ".concat(a));i+=t[a++]}else i+=t[a++]+t[a++];if(o)throw new TypeError("Unbalanced pattern at ".concat(n));if(!i)throw new TypeError("Missing pattern at ".concat(n));e.push({type:"PATTERN",index:n,value:i}),n=a}else{for(var s="",a=n+1;a<t.length;){var u=t.charCodeAt(a);if(!(u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||95===u))break;s+=t[a++]}if(!s)throw new TypeError("Missing parameter name at ".concat(n));e.push({type:"NAME",index:n,value:s}),n=a}else e.push({type:"CLOSE",index:n,value:t[n++]});else e.push({type:"OPEN",index:n,value:t[n++]});else e.push({type:"ESCAPED_CHAR",index:n++,value:t[n++]});else e.push({type:"MODIFIER",index:n,value:t[n++]})}return e.push({type:"END",index:n,value:""}),e}(t),r=e.prefixes,i=void 0===r?"./":r,s="[^".concat(o(e.delimiter||"/#?"),"]+?"),a=[],u=0,c=0,f="",h=function(t){if(c<n.length&&n[c].type===t)return n[c++].value},p=function(t){var e=h(t);if(void 0!==e)return e;var r=n[c],o=r.index;throw new TypeError("Unexpected ".concat(r.type," at ").concat(o,", expected ").concat(t))},d=function(){for(var t,e="";t=h("CHAR")||h("ESCAPED_CHAR");)e+=t;return e};c<n.length;){var l=h("CHAR"),m=h("NAME"),v=h("PATTERN");if(m||v)-1===i.indexOf(w=l||"")&&(f+=w,w=""),f&&(a.push(f),f=""),a.push({name:m||u++,prefix:w,suffix:"",pattern:v||s,modifier:h("MODIFIER")||""});else{var g=l||h("ESCAPED_CHAR");if(g)f+=g;else if(f&&(a.push(f),f=""),h("OPEN")){var w=d(),y=h("NAME")||"",E=h("PATTERN")||"",x=d();p("CLOSE"),a.push({name:y||(E?u++:""),pattern:y&&!E?s:E,prefix:w,suffix:x,modifier:h("MODIFIER")||""})}else p("END")}}return a}(t,n),e,n)}(t,e,n)}function a(){return a=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a.apply(this,arguments)}const u=({hash:t}={})=>location.pathname+location.search+(t?location.hash:"");return class extends n{constructor(t){void 0===t&&(t={}),super(),this.name="SwupRouteNamePlugin",this.requires={swup:">=4"},this.defaults={routes:[],unknownRoute:"unknown",matchOptions:{},paths:!1},this.options=void 0,this.routes=void 0,this.options={...this.defaults,...t},this.routes=this.compileRoutePatterns()}mount(){this.swup.visit.to.route=this.getRouteName(u()),this.updateHistory(this.swup.visit),this.before("visit:start",this.addRouteKey),this.on("animation:out:start",this.addPathClasses),this.on("animation:out:start",this.addRouteClasses),this.on("content:replace",this.updateHistory),this.on("animation:in:end",this.removeClasses)}compileRoutePatterns(){return this.options.routes.map(t=>{const e=this.sanitizeRouteName(t.name),n=((t,e)=>{try{return r(t,e)}catch(e){throw new Error(`[swup] Error parsing path "${t}":\n${e}`)}})(t.path,this.options.matchOptions);return{...t,name:e,matches:n}})}sanitizeRouteName(t){return t.replace(/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~\s]/g,"")}getRouteName(t){const{name:e}=this.routes.find(e=>e.matches(t))||{};return e||void 0}getPathName(t){return String(t).toLowerCase().replace(/[\s/_.]+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+|-+$/g,"")||"homepage"}addRouteKey(t){if(!this.options.routes.length)return;t.from.route=this.getRouteName(t.from.url),t.to.route=this.getRouteName(t.to.url);const e=this.options.unknownRoute;this.swup.log(`Route: '${t.from.route||e||"(unknown)"}' to '${t.to.route||e||"(unknown)"}'`)}addRouteClasses(t){if(!this.options.routes.length)return;const e=t.from.route,n=t.to.route,r=this.options.unknownRoute;(e||r)&&document.documentElement.classList.add(`from-route-${e||r}`),(n||r)&&document.documentElement.classList.add(`to-route-${n||r}`),e&&e===n&&document.documentElement.classList.add("to-same-route")}addPathClasses(t){if(!this.options.paths)return;const e=this.getPathName(t.from.url),n=this.getPathName(t.to.url);document.documentElement.classList.add(`from-${e}`),document.documentElement.classList.add(`to-${n}`)}removeClasses(){const t=document.documentElement.className.split(" ").filter(t=>t.startsWith("from-"));document.documentElement.classList.remove(...t)}updateHistory(t){((t=null,e={})=>{t=t||u({hash:!0});const n=a({},history.state,{url:t,random:Math.random(),source:"swup"},e);history.replaceState(n,"",t)})(void 0,{route:t.to.route})}}});
//# sourceMappingURL=index.umd.js.map
