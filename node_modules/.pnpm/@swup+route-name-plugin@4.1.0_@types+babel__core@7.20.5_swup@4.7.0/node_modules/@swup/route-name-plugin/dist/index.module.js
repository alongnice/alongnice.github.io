import t from"@swup/plugin";import{getCurrentUrl as e,matchPath as s,classify as o,updateHistoryRecord as n}from"swup";class i extends t{constructor(t){void 0===t&&(t={}),super(),this.name="SwupRouteNamePlugin",this.requires={swup:">=4"},this.defaults={routes:[],unknownRoute:"unknown",matchOptions:{},paths:!1},this.options=void 0,this.routes=void 0,this.options={...this.defaults,...t},this.routes=this.compileRoutePatterns()}mount(){this.swup.visit.to.route=this.getRouteName(e()),this.updateHistory(this.swup.visit),this.before("visit:start",this.addRouteKey),this.on("animation:out:start",this.addPathClasses),this.on("animation:out:start",this.addRouteClasses),this.on("content:replace",this.updateHistory),this.on("animation:in:end",this.removeClasses)}compileRoutePatterns(){return this.options.routes.map(t=>{const e=this.sanitizeRouteName(t.name),o=s(t.path,this.options.matchOptions);return{...t,name:e,matches:o}})}sanitizeRouteName(t){return t.replace(/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~\s]/g,"")}getRouteName(t){const{name:e}=this.routes.find(e=>e.matches(t))||{};return e||void 0}getPathName(t){return o(t)||"homepage"}addRouteKey(t){if(!this.options.routes.length)return;t.from.route=this.getRouteName(t.from.url),t.to.route=this.getRouteName(t.to.url);const e=this.options.unknownRoute;this.swup.log(`Route: '${t.from.route||e||"(unknown)"}' to '${t.to.route||e||"(unknown)"}'`)}addRouteClasses(t){if(!this.options.routes.length)return;const e=t.from.route,s=t.to.route,o=this.options.unknownRoute;(e||o)&&document.documentElement.classList.add(`from-route-${e||o}`),(s||o)&&document.documentElement.classList.add(`to-route-${s||o}`),e&&e===s&&document.documentElement.classList.add("to-same-route")}addPathClasses(t){if(!this.options.paths)return;const e=this.getPathName(t.from.url),s=this.getPathName(t.to.url);document.documentElement.classList.add(`from-${e}`),document.documentElement.classList.add(`to-${s}`)}removeClasses(){const t=document.documentElement.className.split(" ").filter(t=>t.startsWith("from-"));document.documentElement.classList.remove(...t)}updateHistory(t){n(void 0,{route:t.to.route})}}export{i as default};
//# sourceMappingURL=index.module.js.map
