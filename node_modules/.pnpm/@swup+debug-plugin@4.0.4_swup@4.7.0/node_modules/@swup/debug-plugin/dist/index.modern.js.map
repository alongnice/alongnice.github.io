{"version":3,"file":"index.modern.js","sources":["../src/index.ts"],"sourcesContent":["import Plugin from '@swup/plugin';\nimport type { Swup, HookName, HookArguments } from 'swup';\n\ndeclare global {\n\tinterface Window {\n\t\tswup?: Swup;\n\t}\n}\n\ntype Options = {\n\tglobalInstance: boolean;\n};\n\nexport default class SwupDebugPlugin extends Plugin {\n\tname = 'SwupDebugPlugin';\n\n\trequires = { swup: '>=4' };\n\n\tdefaults: Options = {\n\t\tglobalInstance: false\n\t};\n\toptions: Options;\n\toriginalSwupLog?: Swup['log'];\n\toriginalSwupHookCall?: Swup['hooks']['call'];\n\toriginalSwupHookCallSync?: Swup['hooks']['callSync'];\n\n\tconstructor(options = {}) {\n\t\tsuper();\n\t\tthis.options = { ...this.defaults, ...options };\n\t}\n\n\tmount() {\n\t\tconst swup = this.swup;\n\n\t\t// set non-empty log method of swup\n\t\tthis.originalSwupLog = swup.log;\n\t\tswup.log = this.log;\n\n\t\t// set swup instance as a global variable swup\n\t\tif (this.options.globalInstance) {\n\t\t\twindow.swup = swup;\n\t\t}\n\n\t\t// check if title tag is present\n\t\tif (!document.getElementsByTagName('title').length) {\n\t\t\tthis.warn(`This page doesn't have a title tag. It is required on every page.`);\n\t\t}\n\n\t\t// make hook calls appear in console\n\t\tthis.originalSwupHookCall = swup.hooks.call.bind(swup.hooks);\n\t\tthis.originalSwupHookCallSync = swup.hooks.callSync.bind(swup.hooks);\n\t\tswup.hooks.call = this.callHook.bind(this);\n\t\tswup.hooks.callSync = this.callHookSync.bind(this);\n\t}\n\n\tunmount() {\n\t\tsuper.unmount();\n\n\t\tthis.swup.log = this.originalSwupLog!;\n\t\tthis.swup.hooks.call = this.originalSwupHookCall!;\n\t\tthis.swup.hooks.callSync = this.originalSwupHookCallSync!;\n\t\tif (this.options.globalInstance) {\n\t\t\twindow.swup = undefined;\n\t\t}\n\t}\n\n\tlogHook<T extends HookName>(hook: T, args: HookArguments<T>) {\n\t\tconsole.groupCollapsed('%cswup:' + '%c' + hook, 'color: #343434', 'color: #009ACD');\n\t\tconsole.log(args);\n\t\tconsole.groupEnd();\n\t}\n\n\tcallHook: Swup['hooks']['call'] = (hook, args, ...rest) => {\n\t\tthis.logHook(hook, args);\n\t\treturn this.originalSwupHookCall!(hook, args, ...rest);\n\t};\n\n\tcallHookSync: Swup['hooks']['callSync'] = (hook, args, ...rest) => {\n\t\tthis.logHook(hook, args);\n\t\treturn this.originalSwupHookCallSync!(hook, args, ...rest);\n\t};\n\n\tlog(str: string, object: any): void {\n\t\tif (object) {\n\t\t\tconsole.groupCollapsed(str);\n\t\t\tfor (let key in object) {\n\t\t\t\tconsole.log(object[key]);\n\t\t\t}\n\t\t\tconsole.groupEnd();\n\t\t} else {\n\t\t\tconsole.log(str + '%c', 'color: #009ACD');\n\t\t}\n\t}\n\n\twarn(str: string): void {\n\t\tconsole.warn(`[swup debug plugin] ${str}`);\n\t}\n\n\terror(str: string): void {\n\t\tconsole.error(`[swup debug plugin] ${str}`);\n\t}\n}\n"],"names":["SwupDebugPlugin","Plugin","constructor","options","super","this","name","requires","swup","defaults","globalInstance","originalSwupLog","originalSwupHookCall","originalSwupHookCallSync","callHook","hook","args","rest","logHook","callHookSync","_extends","mount","log","window","document","getElementsByTagName","length","warn","hooks","call","bind","callSync","unmount","undefined","console","groupCollapsed","groupEnd","str","object","key","error"],"mappings":"gQAaqB,MAAAA,UAAwBC,EAa5CC,WAAAA,CAAYC,EAAU,CAAE,GACvBC,QAAQC,KAbTC,KAAO,kBAAiBD,KAExBE,SAAW,CAAEC,KAAM,OAEnBC,KAAAA,SAAoB,CACnBC,gBAAgB,GAChBL,KACDF,aACAQ,EAAAA,KAAAA,qBACAC,EAAAA,KAAAA,0BACAC,EAAAA,KAAAA,qCAgDAC,SAAkC,CAACC,EAAMC,KAASC,KACjDZ,KAAKa,QAAQH,EAAMC,GACZX,KAAKO,qBAAsBG,EAAMC,KAASC,SAGlDE,aAA0C,CAACJ,EAAMC,KAASC,KACzDZ,KAAKa,QAAQH,EAAMC,GACRX,KAACQ,yBAA0BE,EAAMC,KAASC,IAnDrDZ,KAAKF,QAAOiB,EAAA,CAAA,EAAQf,KAAKI,SAAaN,EACvC,CAEAkB,KAAAA,GACC,MAAMb,EAAOH,KAAKG,KAGlBH,KAAKM,gBAAkBH,EAAKc,IAC5Bd,EAAKc,IAAMjB,KAAKiB,IAGZjB,KAAKF,QAAQO,iBAChBa,OAAOf,KAAOA,GAIVgB,SAASC,qBAAqB,SAASC,QAC3CrB,KAAKsB,KAAK,qEAIXtB,KAAKO,qBAAuBJ,EAAKoB,MAAMC,KAAKC,KAAKtB,EAAKoB,OACtDvB,KAAKQ,yBAA2BL,EAAKoB,MAAMG,SAASD,KAAKtB,EAAKoB,OAC9DpB,EAAKoB,MAAMC,KAAOxB,KAAKS,SAASgB,KAAKzB,MACrCG,EAAKoB,MAAMG,SAAW1B,KAAKc,aAAaW,KAAKzB,KAC9C,CAEA2B,OAAAA,GACC5B,MAAM4B,UAEN3B,KAAKG,KAAKc,IAAMjB,KAAKM,gBACrBN,KAAKG,KAAKoB,MAAMC,KAAOxB,KAAKO,qBAC5BP,KAAKG,KAAKoB,MAAMG,SAAW1B,KAAKQ,yBAC5BR,KAAKF,QAAQO,iBAChBa,OAAOf,UAAOyB,EAEhB,CAEAf,OAAAA,CAA4BH,EAASC,GACpCkB,QAAQC,eAAe,YAAmBpB,EAAM,iBAAkB,kBAClEmB,QAAQZ,IAAIN,GACZkB,QAAQE,UACT,CAYAd,GAAAA,CAAIe,EAAaC,GAChB,GAAIA,EAAQ,CACXJ,QAAQC,eAAeE,GACvB,IAAK,IAAIE,KAAOD,EACfJ,QAAQZ,IAAIgB,EAAOC,IAEpBL,QAAQE,UACR,MACAF,QAAQZ,IAAIe,EAAM,KAAM,iBAE1B,CAEAV,IAAAA,CAAKU,GACJH,QAAQP,4BAA4BU,IACrC,CAEAG,KAAAA,CAAMH,GACLH,QAAQM,6BAA6BH,IACtC"}